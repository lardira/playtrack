<script lang="ts">
    import Chart from "$lib/components/Chart.svelte";
    export let data;

    const rows = [...data.leaderboard].sort((a, b) => b.total - a.total);
</script>

<div class="container mx-auto px-4 space-y-8">
    <header>
        <h1 class="text-4xl font-bold">üèÜ Leaderboard</h1>
        <p class="text-surface-500">–†–µ–π—Ç–∏–Ω–≥ –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –æ—á–∫–∞–º –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º</p>
    </header>

    {#if rows.length}
        <Chart data={rows} players={data.players} />
    {/if}

    <div class="overflow-x-auto">
        <table class="table w-full">
            <thead>
                <tr>
                    <th>–ú–µ—Å—Ç–æ</th><th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th><th>–¢–µ–∫—É—â–∞—è –∏–≥—Ä–∞</th><th
                        >–ü–æ–∏–Ω—Ç—ã</th
                    ><th>–ü—Ä–æ–π–¥–µ–Ω–æ</th><th>–î—Ä–æ–ø</th><th>–†–µ—Ä–æ–ª–ª</th>
                </tr>
            </thead>
            <tbody>
                {#each rows as row, i}
                    <tr
                        class="hover:bg-surface-700/40 {i === 0
                            ? 'bg-primary-500/10'
                            : ''}"
                    >
                        <td
                            >{i + 1}
                            {i === 0
                                ? "ü•á"
                                : i === 1
                                  ? "ü•à"
                                  : i === 2
                                    ? "ü•â"
                                    : ""}</td
                        >
                        <td>
                            <a
                                href="/users/{row.Player_id}"
                                class="font-semibold text-primary-400 hover:text-primary-300"
                            >
                                {data.players.find(
                                    (p) => p.ID === row.Player_id,
                                )?.Username} ‚Üí
                            </a>
                        </td>
                        <td>{row.current_game ?? "–ü–µ—Ä–µ—Ä—ã–≤"}</td>
                        <td
                            ><span class="badge variant-soft-warning"
                                >{row.total}</span
                            ></td
                        >
                        <td
                            ><span class="badge variant-soft-success"
                                >{row.comleted}</span
                            ></td
                        >
                        <td
                            ><span class="badge variant-soft-error"
                                >{row.drop}</span
                            ></td
                        >
                        <td
                            ><span class="badge variant-soft-warning"
                                >{row.reroll}</span
                            ></td
                        >
                    </tr>
                {/each}
            </tbody>
        </table>
    </div>
</div>
